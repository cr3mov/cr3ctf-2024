from sage.all import *
from Crypto.Util.number import long_to_bytes

p = 14989068425250509519
pudge = 488021842552697485963550845809830956869265678611663884519824835144279897263760519070556811395650

A = matrix(GF(p), [
    [2316580867395718488, 48426743017495202, 10035688260900924039, 4231347989577694113, 10589292030513420982],
    [13855044643446484404, 5232761037656480890, 8292975196384415335, 6347855203040361884, 1695816437660153737],
    [13046242976127835996, 9475110516100642016, 4727306285316450578, 4641412090997841438, 12402034468342504110],
    [2367861295557041099, 7972370016088296064, 2345756074442706631, 5466959662134124819, 7703316732710858490],
    [3154951152478314029, 14631229995381692381, 8791489668576804292, 14058045966950055197, 6886936172143671821]
])
A_1 = matrix(GF(p), [
    [10449681695550103501, 1032827731769907364, 8551846352768290089, 2528206462071885652, 4668517139358847432],
    [8129949521585158431, 8663150094657298270, 13611618663064384279, 11990726265981907640, 8736574751606166199],
    [13477489095760140976, 4129645872383074495, 802354481887101565, 5918883130626557767, 4293067273646165724],
    [3218110987866379647, 13155490303126428937, 10511509599742650284, 10905345492015529131, 8890727867148431908],
    [6267270344792504320, 1272127850159541188, 9155031196436204158, 13829185043890037978, 2887328975771996112]
])

pow = discrete_log(det(A_1), det(A))
assert (A ** pow == A_1)
order = 1
while A ** (p ** order - 1) != matrix(GF(p), identity_matrix(5)):
    order += 1
b = int(sqrt(Mod(5, p ** order - 1)))
flag = (Mod(int((1 + b) // 2) + 0, p ** order - 1) ** (2 ** 322 - 228) + Mod(int((1 - b) // 2) + 0, p ** order - 1) ** (2 ** 322 - 228) - pudge)

print(flag)
print(long_to_bytes(int(flag)))
